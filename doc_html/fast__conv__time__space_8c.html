<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<title>CrusDe: plugin_src/operator/fast_conv_time_space.c File Reference</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<link href="doxygen.css" rel="stylesheet" type="text/css"/>
</head>
<body>
<!-- Generated by Doxygen 1.6.1-20091004 -->
<div class="navigation" id="top">
  <div class="tabs">
    <ul>
      <li><a href="main.html"><span>Main&nbsp;Page</span></a></li>
      <li><a href="modules.html"><span>Modules</span></a></li>
      <li><a href="annotated.html"><span>Classes</span></a></li>
      <li class="current"><a href="files.html"><span>Files</span></a></li>
    </ul>
  </div>
  <div class="tabs">
    <ul>
      <li><a href="files.html"><span>File&nbsp;List</span></a></li>
      <li><a href="globals.html"><span>File&nbsp;Members</span></a></li>
    </ul>
  </div>
</div>
<div class="contents">
<h1>plugin_src/operator/fast_conv_time_space.c File Reference</h1><code>#include &lt;complex.h&gt;</code><br/>
<code>#include &lt;fftw3.h&gt;</code><br/>
<code>#include &quot;<a class="el" href="crusde__api_8h_source.html">crusde_api.h</a>&quot;</code><br/>
<code>#include &lt;stdarg.h&gt;</code><br/>
<code>#include &lt;stdio.h&gt;</code><br/>
<code>#include &lt;time.h&gt;</code><br/>
<code>#include &lt;math.h&gt;</code><br/>
<div class="dynheader">
Include dependency graph for fast_conv_time_space.c:</div>
<div class="dynsection">
<div class="center"><img src="fast__conv__time__space_8c__incl.png" border="0" usemap="#plugin__src_2operator_2fast__conv__time__space_8c_map" alt=""/></div>
<map name="plugin__src_2operator_2fast__conv__time__space_8c_map" id="plugin__src_2operator_2fast__conv__time__space_8c">
<area shape="rect" href="crusde__api_8h.html" title="crusde_api.h" alt="" coords="195,80,291,107"/><area shape="rect" href="constants_8h.html" title="constants.h" alt="" coords="93,155,181,181"/><area shape="rect" href="config_8h.html" title="config.h" alt="" coords="205,155,272,181"/></map>
</div>
<table border="0" cellpadding="0" cellspacing="0">
<tr><td colspan="2"><h2>Defines</h2></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">#define&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="fast__conv__time__space_8c.html#af3bc7c37d03ab1640ac95f8590998b03">RESET</a>(<a class="el" href="fast__conv__time__space_8c.html#a6150e0515f7202e2fb518f7206ed97dc">x</a>, <a class="el" href="fast__conv__time__space_8c.html#a0a2f84ed7838f07779ae24c5a9086d33">y</a>)&nbsp;&nbsp;&nbsp;(<a class="el" href="fast__conv__time__space_8c.html#a6150e0515f7202e2fb518f7206ed97dc">x</a> = <a class="el" href="fast__conv__time__space_8c.html#a0a2f84ed7838f07779ae24c5a9086d33">y</a> = -1)</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">#define&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="fast__conv__time__space_8c.html#a875014a357b715f68bda021dae58b9df">POSITION</a>(m, <a class="el" href="fast__conv__time__space_8c.html#a76f11d9a0a47b94f72c2d0e77fb32240">n</a>)&nbsp;&nbsp;&nbsp;(<a class="el" href="fast__conv__time__space_8c.html#a76f11d9a0a47b94f72c2d0e77fb32240">n</a>+(<a class="el" href="fast__conv_8c.html#aa0502deb9a90394ee1512fae8a5e95a8">N_Y</a>)*m)</td></tr>
<tr><td colspan="2"><h2>Functions</h2></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">void&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="fast__conv__time__space_8c.html#a92474723fd5c3c7a92d5de73ccc9fdab">register_output_fields</a> ()</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">void&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="fast__conv__time__space_8c.html#a8d8a340c9e92212550682cb42d078ca1">register_parameter</a> ()</td></tr>
<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Register parameters this Kernel claims from the input.  <a href="#a8d8a340c9e92212550682cb42d078ca1"></a><br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">void&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="fast__conv__time__space_8c.html#a6b7aad3f14d45970fb736b953048c303">request_plugins</a> ()</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">void&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="fast__conv__time__space_8c.html#a02fd73d861ef2e4aabb38c0c9ff82947">init</a> ()</td></tr>
<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Initialization of the convolution. Allocation of memory for inputs and outputs.  <a href="#a02fd73d861ef2e4aabb38c0c9ff82947"></a><br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">void&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="fast__conv__time__space_8c.html#ac8bb3912a3ce86b15842e79d0b421204">clear</a> ()</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">void&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="fast__conv__time__space_8c.html#a13a43e6d814de94978c515cb084873b1">run</a> ()</td></tr>
<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Performs the fast convolution.  <a href="#a13a43e6d814de94978c515cb084873b1"></a><br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">const char *&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="fast__conv__time__space_8c.html#aa37ab6a2f004bfa2c956115231072736">get_name</a> ()</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">const char *&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="fast__conv__time__space_8c.html#a5620c12b88f92fa8437f2b92b9cc661a">get_version</a> ()</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">const char *&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="fast__conv__time__space_8c.html#a9cb7fa4e5ce704ea89aa0b19de319df1">get_authors</a> ()</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">const char *&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="fast__conv__time__space_8c.html#ad42f030a1d29113cb23fad72f54e5220">get_description</a> ()</td></tr>
<tr><td class="memItemLeft" align="right" valign="top"><a class="el" href="crusde__api_8h.html#a8e337e7fa33f330390bbd59f2cd2b37a">PluginCategory</a>&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="fast__conv__time__space_8c.html#a6718e3375be209c3b30dfdf84f7ebc9c">get_category</a> ()</td></tr>
<tr><td colspan="2"><h2>Variables</h2></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">double *&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="fast__conv__time__space_8c.html#a750bb45baeee8638cf5e5d206e6c3949">decay_in</a></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">double *&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="fast__conv__time__space_8c.html#a254d2de8bdf67e63ad5e840cc445ad2e">history_in</a></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">double *&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="fast__conv__time__space_8c.html#a34a1dd74a6b1cca1cd818e4fe89125fb">conv_out</a></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">double **&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="fast__conv__time__space_8c.html#aea8a6f9088ed4b42929784a94079a883">spatial_result</a></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">fftw_complex *&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="fast__conv__time__space_8c.html#a3ebf135f42528ee8a47f822402a90881">decay_out</a></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">fftw_complex *&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="fast__conv__time__space_8c.html#a97c9c64abff99f75e57ed787ed3f43f4">history_out</a></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">fftw_complex *&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="fast__conv__time__space_8c.html#aa3295db347da34abf2aa3f9c0a8495b3">conv_in</a></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">fftw_plan&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="fast__conv__time__space_8c.html#aa9d4603278fe2a4bfa666c85e262ccbf">decay_plan</a></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">fftw_plan&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="fast__conv__time__space_8c.html#a753e1caabad13e222ee7553d7b46760c">history_plan</a></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">fftw_plan&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="fast__conv__time__space_8c.html#a210769c669f4161b1762f71f01b634b7">conv_plan</a></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">double **&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="fast__conv__time__space_8c.html#ac8f4ef93038519a7ba6386b27dd938f1">result</a></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">int&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="fast__conv__time__space_8c.html#abe83d1f66400372638644ff6e86f0fb3">N_T</a></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">int&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="fast__conv__time__space_8c.html#a75532c590dd7f2d95b9756a3edfc69e2">size_T</a> = 0</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">int&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="fast__conv__time__space_8c.html#a649a9e98ec855fe65a8ab6125d027560">size_X</a> = 0</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">int&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="fast__conv__time__space_8c.html#aaa037180b6867f0f6ea6638aa41328ba">size_Y</a> = 0</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">int&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="fast__conv__time__space_8c.html#a6150e0515f7202e2fb518f7206ed97dc">x</a> = -1</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">int&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="fast__conv__time__space_8c.html#a0a2f84ed7838f07779ae24c5a9086d33">y</a> = -1</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">int&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="fast__conv__time__space_8c.html#acb559820d9ca11295b4500f179ef6392">i</a> = 0</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">int&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="fast__conv__time__space_8c.html#a76f11d9a0a47b94f72c2d0e77fb32240">n</a> = -1</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">unsigned long int&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="fast__conv__time__space_8c.html#a8668751464d9f21f49861f2c4c8b211e">t</a> = 0</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">int&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="fast__conv__time__space_8c.html#a78e729da50af649061e409638ea413e1">dimensions</a> = 1</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">int&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="fast__conv__time__space_8c.html#abcd1d810535dcc0097a913eecc39397f">displacement_dimensions</a> = 1</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">boolean&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="fast__conv__time__space_8c.html#a600899410b53ff3d9f23d19a43f4d8d8">is_initialized</a> = false</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">void(*&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="fast__conv__time__space_8c.html#a1e2137d932e474fce316e4ca61db76c9">fast_spatial_conv</a> )() = NULL</td></tr>
</table>
<hr/><a name="_details"></a><h2>Detailed Description</h2>
<p>Implements a fast convolution using the Fast Fourier Transform (DFT). This <a class="el" href="classPlugin.html">Plugin</a> depends on the FFTW3 library, <a href="http://www.fftw3.org">http://www.fftw3.org</a> , which is used to allow convolution in the spectral domain (see convolution theorem). </p>
<hr/><h2>Define Documentation</h2>
<a class="anchor" id="a875014a357b715f68bda021dae58b9df"></a><!-- doxytag: member="fast_conv_time_space.c::POSITION" ref="a875014a357b715f68bda021dae58b9df" args="(m, n)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define POSITION</td>
          <td>(</td>
          <td class="paramtype">m, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="fast__conv__time__space_8c.html#a76f11d9a0a47b94f72c2d0e77fb32240">n</a>&nbsp;</td>
          <td class="paramname"></td>
          <td>&nbsp;)&nbsp;</td>
          <td>&nbsp;&nbsp;&nbsp;(<a class="el" href="fast__conv__time__space_8c.html#a76f11d9a0a47b94f72c2d0e77fb32240">n</a>+(<a class="el" href="fast__conv_8c.html#aa0502deb9a90394ee1512fae8a5e95a8">N_Y</a>)*m)</td>
        </tr>
      </table>
</div>
<div class="memdoc">

</div>
</div>
<a class="anchor" id="af3bc7c37d03ab1640ac95f8590998b03"></a><!-- doxytag: member="fast_conv_time_space.c::RESET" ref="af3bc7c37d03ab1640ac95f8590998b03" args="(x, y)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define RESET</td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="fast__conv__time__space_8c.html#a6150e0515f7202e2fb518f7206ed97dc">x</a>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="fast__conv__time__space_8c.html#a0a2f84ed7838f07779ae24c5a9086d33">y</a>&nbsp;</td>
          <td class="paramname"></td>
          <td>&nbsp;)&nbsp;</td>
          <td>&nbsp;&nbsp;&nbsp;(<a class="el" href="fast__conv__time__space_8c.html#a6150e0515f7202e2fb518f7206ed97dc">x</a> = <a class="el" href="fast__conv__time__space_8c.html#a0a2f84ed7838f07779ae24c5a9086d33">y</a> = -1)</td>
        </tr>
      </table>
</div>
<div class="memdoc">

</div>
</div>
<hr/><h2>Function Documentation</h2>
<a class="anchor" id="ac8bb3912a3ce86b15842e79d0b421204"></a><!-- doxytag: member="fast_conv_time_space.c::clear" ref="ac8bb3912a3ce86b15842e79d0b421204" args="()" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void clear </td>
          <td>(</td>
          <td class="paramname"></td>
          <td>&nbsp;)&nbsp;</td>
          <td></td>
        </tr>
      </table>
</div>
<div class="memdoc">
<p>Frees memory allocated during <a class="el" href="exponential_8c.html#a02fd73d861ef2e4aabb38c0c9ff82947" title="Initialization of the convolution. Allocation of memory for inputs and outputs.">init()</a>. FFTW plans are destroyed. </p>

<p>References <a class="el" href="fast__conv_8c_source.html#l00035">conv_in</a>, <a class="el" href="fast__conv_8c_source.html#l00034">conv_out</a>, <a class="el" href="fast__conv_8c_source.html#l00036">conv_plan</a>, <a class="el" href="fast__conv__time__space_8c_source.html#l00034">decay_in</a>, <a class="el" href="fast__conv__time__space_8c_source.html#l00035">decay_out</a>, <a class="el" href="fast__conv__time__space_8c_source.html#l00036">decay_plan</a>, <a class="el" href="fast__conv_8c_source.html#l00045">dimensions</a>, <a class="el" href="fast__conv__time__space_8c_source.html#l00034">history_in</a>, <a class="el" href="fast__conv__time__space_8c_source.html#l00035">history_out</a>, <a class="el" href="fast__conv__time__space_8c_source.html#l00036">history_plan</a>, <a class="el" href="fast__conv_8c_source.html#l00048">is_initialized</a>, <a class="el" href="fast__conv_8c_source.html#l00043">n</a>, and <a class="el" href="conv_8c_source.html#l00027">result</a>.</p>

</div>
</div>
<a class="anchor" id="a9cb7fa4e5ce704ea89aa0b19de319df1"></a><!-- doxytag: member="fast_conv_time_space.c::get_authors" ref="a9cb7fa4e5ce704ea89aa0b19de319df1" args="()" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">const char* get_authors </td>
          <td>(</td>
          <td class="paramname"></td>
          <td>&nbsp;)&nbsp;</td>
          <td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

</div>
</div>
<a class="anchor" id="a6718e3375be209c3b30dfdf84f7ebc9c"></a><!-- doxytag: member="fast_conv_time_space.c::get_category" ref="a6718e3375be209c3b30dfdf84f7ebc9c" args="()" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="crusde__api_8h.html#a8e337e7fa33f330390bbd59f2cd2b37a">PluginCategory</a> get_category </td>
          <td>(</td>
          <td class="paramname"></td>
          <td>&nbsp;)&nbsp;</td>
          <td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>References <a class="el" href="crusde__api_8h_source.html#l00049">KERNEL_PLUGIN</a>.</p>

</div>
</div>
<a class="anchor" id="ad42f030a1d29113cb23fad72f54e5220"></a><!-- doxytag: member="fast_conv_time_space.c::get_description" ref="ad42f030a1d29113cb23fad72f54e5220" args="()" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">const char* get_description </td>
          <td>(</td>
          <td class="paramname"></td>
          <td>&nbsp;)&nbsp;</td>
          <td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

</div>
</div>
<a class="anchor" id="aa37ab6a2f004bfa2c956115231072736"></a><!-- doxytag: member="fast_conv_time_space.c::get_name" ref="aa37ab6a2f004bfa2c956115231072736" args="()" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">const char* get_name </td>
          <td>(</td>
          <td class="paramname"></td>
          <td>&nbsp;)&nbsp;</td>
          <td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

</div>
</div>
<a class="anchor" id="a5620c12b88f92fa8437f2b92b9cc661a"></a><!-- doxytag: member="fast_conv_time_space.c::get_version" ref="a5620c12b88f92fa8437f2b92b9cc661a" args="()" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">const char* get_version </td>
          <td>(</td>
          <td class="paramname"></td>
          <td>&nbsp;)&nbsp;</td>
          <td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

</div>
</div>
<a class="anchor" id="a02fd73d861ef2e4aabb38c0c9ff82947"></a><!-- doxytag: member="fast_conv_time_space.c::init" ref="a02fd73d861ef2e4aabb38c0c9ff82947" args="()" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void init </td>
          <td>(</td>
          <td class="paramname"></td>
          <td>&nbsp;)&nbsp;</td>
          <td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Initialization of the convolution. Allocation of memory for inputs and outputs. </p>
<p>The field sizes are adjusted according to the needs to avoid wrap around effects in the spectal domain and allow for effective use of DFT (lenght and width are a power of 2). Memory is allocated using fftw_malloc for DFT inputs and outputs (load_in, load_out, green_in, green_out, conv_in, conv_out). Three FFTW plans are created for DFT transform of Green and load arrays and IDFT of the convolution result back to original domain. </p>

<p>References <a class="el" href="fast__conv_8c_source.html#l00035">conv_in</a>, <a class="el" href="fast__conv_8c_source.html#l00034">conv_out</a>, <a class="el" href="fast__conv_8c_source.html#l00036">conv_plan</a>, <a class="el" href="crusde__api_8cpp_source.html#l00290">crusde_get_dimensions()</a>, <a class="el" href="crusde__api_8cpp_source.html#l00295">crusde_get_displacement_dimensions()</a>, <a class="el" href="crusde__api_8cpp_source.html#l00270">crusde_get_size_x()</a>, <a class="el" href="crusde__api_8cpp_source.html#l00275">crusde_get_size_y()</a>, <a class="el" href="crusde__api_8cpp_source.html#l00353">crusde_get_timesteps()</a>, <a class="el" href="fast__conv__time__space_8c_source.html#l00034">decay_in</a>, <a class="el" href="fast__conv__time__space_8c_source.html#l00035">decay_out</a>, <a class="el" href="fast__conv__time__space_8c_source.html#l00036">decay_plan</a>, <a class="el" href="fast__conv_8c_source.html#l00045">dimensions</a>, <a class="el" href="fast__conv_8c_source.html#l00046">displacement_dimensions</a>, <a class="el" href="fast__conv__time__space_8c_source.html#l00034">history_in</a>, <a class="el" href="fast__conv__time__space_8c_source.html#l00035">history_out</a>, <a class="el" href="fast__conv__time__space_8c_source.html#l00036">history_plan</a>, <a class="el" href="conv_8c_source.html#l00031">i</a>, <a class="el" href="fast__conv_8c_source.html#l00048">is_initialized</a>, <a class="el" href="fast__conv_8c_source.html#l00043">n</a>, <a class="el" href="fast__conv__time__space_8c_source.html#l00041">N_T</a>, <a class="el" href="conv_8c_source.html#l00027">result</a>, <a class="el" href="fast__conv__time__space_8c_source.html#l00042">size_T</a>, <a class="el" href="fast__conv__time__space_8c_source.html#l00042">size_X</a>, <a class="el" href="fast__conv__time__space_8c_source.html#l00042">size_Y</a>, and <a class="el" href="conv_8c_source.html#l00031">x</a>.</p>

</div>
</div>
<a class="anchor" id="a92474723fd5c3c7a92d5de73ccc9fdab"></a><!-- doxytag: member="fast_conv_time_space.c::register_output_fields" ref="a92474723fd5c3c7a92d5de73ccc9fdab" args="()" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void register_output_fields </td>
          <td>(</td>
          <td class="paramname"></td>
          <td>&nbsp;)&nbsp;</td>
          <td></td>
        </tr>
      </table>
</div>
<div class="memdoc">
<p>empty </p>

</div>
</div>
<a class="anchor" id="a8d8a340c9e92212550682cb42d078ca1"></a><!-- doxytag: member="fast_conv_time_space.c::register_parameter" ref="a8d8a340c9e92212550682cb42d078ca1" args="()" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void register_parameter </td>
          <td>(</td>
          <td class="paramname"></td>
          <td>&nbsp;)&nbsp;</td>
          <td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Register parameters this Kernel claims from the input. </p>
<p>This plugin calls register_kernel_param() defined in <a class="el" href="crusde__api_8h.html">crusde_api.h</a> to register references to parameters this Kernel will need to operate properly. For command line use the order of registration in this function defines the identification of parameters in the command line string (i.e. './green -KfirstRegistered/secondRegistered/...'). In case an XML is used to configure the experiment, the reference to this parameter will be identified by the string passed as second argument to register_kernel_param().</p>
<p>This function registers the references in the following order:</p>
<p>Thus, the command line parameter string is: <code>-K</code></p>
<dl class="see"><dt><b>See also:</b></dt><dd>register_kernel_param() </dd>
<dd>
<a class="el" href="exponential_8c.html#a8d8a340c9e92212550682cb42d078ca1" title="Register parameters this Kernel claims from the input.">register_parameter()</a> (<a class="el" href="temp__plugin_8c_8tmp.html">temp_plugin.c.tmp</a>) </dd></dl>

</div>
</div>
<a class="anchor" id="a6b7aad3f14d45970fb736b953048c303"></a><!-- doxytag: member="fast_conv_time_space.c::request_plugins" ref="a6b7aad3f14d45970fb736b953048c303" args="()" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void request_plugins </td>
          <td>(</td>
          <td class="paramname"></td>
          <td>&nbsp;)&nbsp;</td>
          <td></td>
        </tr>
      </table>
</div>
<div class="memdoc">
<p>we re-use spatial convolution! </p>

<p>References <a class="el" href="crusde__api_8cpp_source.html#l00438">crusde_request_kernel_plugin()</a>, and <a class="el" href="fast__conv__time__space_8c.html#a1e2137d932e474fce316e4ca61db76c9">fast_spatial_conv</a>.</p>

</div>
</div>
<a class="anchor" id="a13a43e6d814de94978c515cb084873b1"></a><!-- doxytag: member="fast_conv_time_space.c::run" ref="a13a43e6d814de94978c515cb084873b1" args="()" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void run </td>
          <td>(</td>
          <td class="paramname"></td>
          <td>&nbsp;)&nbsp;</td>
          <td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Performs the fast convolution. </p>
<p>Requests values for each point in the examined area from Green's function (only once when modeltime == 0) and load function (every timestep). Does the origin shifting necessary for the Green's function values. The Green's function values are requested for each displacement direction the Green's function registered with the CrusDe.</p>
<p>FFTW plan is executed for the load. Then for each Green's function displacement direction the FFTW plan is executed, a complex multiplication of the DFT results performed and then for product the FFTW plan is executed (IDFT). The result of the convolution is extracted from the oversized IDFT result and cropped to the original size of the examined region.</p>
<p>ATTN: result[d][x] still holds the values from the last time run was called. This way adding up the results of multiple jobs is realized! </p>

<p>References <a class="el" href="fast__conv_8c_source.html#l00035">conv_in</a>, <a class="el" href="fast__conv_8c_source.html#l00034">conv_out</a>, <a class="el" href="fast__conv_8c_source.html#l00036">conv_plan</a>, <a class="el" href="crusde__api_8cpp_source.html#l00399">crusde_crustal_decay_given()</a>, <a class="el" href="crusde__api_8cpp_source.html#l00119">crusde_debug()</a>, <a class="el" href="crusde__api_8cpp_source.html#l00265">crusde_get_crustal_decay_at()</a>, <a class="el" href="crusde__api_8cpp_source.html#l00255">crusde_get_load_history_at()</a>, <a class="el" href="crusde__api_8cpp_source.html#l00260">crusde_get_number_of_loads()</a>, <a class="el" href="crusde__api_8cpp_source.html#l00315">crusde_get_result()</a>, <a class="el" href="crusde__api_8cpp_source.html#l00404">crusde_load_history_given()</a>, <a class="el" href="crusde__api_8cpp_source.html#l00348">crusde_model_time()</a>, <a class="el" href="crusde__api_8cpp_source.html#l00389">crusde_set_current_load_component()</a>, <a class="el" href="table_8c_source.html#l00036">d</a>, <a class="el" href="fast__conv__time__space_8c_source.html#l00034">decay_in</a>, <a class="el" href="fast__conv__time__space_8c_source.html#l00035">decay_out</a>, <a class="el" href="fast__conv__time__space_8c_source.html#l00036">decay_plan</a>, <a class="el" href="fast__conv_8c_source.html#l00046">displacement_dimensions</a>, <a class="el" href="fast__conv__time__space_8c.html#a1e2137d932e474fce316e4ca61db76c9">fast_spatial_conv</a>, <a class="el" href="fast__conv__time__space_8c_source.html#l00034">history_in</a>, <a class="el" href="fast__conv__time__space_8c_source.html#l00035">history_out</a>, <a class="el" href="fast__conv__time__space_8c_source.html#l00036">history_plan</a>, <a class="el" href="conv_8c_source.html#l00031">i</a>, <a class="el" href="fast__conv_8c_source.html#l00043">n</a>, <a class="el" href="fast__conv__time__space_8c_source.html#l00041">N_T</a>, <a class="el" href="fast__conv_8c_source.html#l00030">RESET</a>, <a class="el" href="conv_8c_source.html#l00027">result</a>, <a class="el" href="fast__conv__time__space_8c_source.html#l00042">size_T</a>, <a class="el" href="fast__conv__time__space_8c_source.html#l00042">size_X</a>, <a class="el" href="fast__conv__time__space_8c_source.html#l00042">size_Y</a>, <a class="el" href="fast__conv__time__space_8c_source.html#l00034">spatial_result</a>, <a class="el" href="fast__conv_8c_source.html#l00044">t</a>, <a class="el" href="conv_8c_source.html#l00031">x</a>, and <a class="el" href="conv_8c_source.html#l00031">y</a>.</p>

</div>
</div>
<hr/><h2>Variable Documentation</h2>
<a class="anchor" id="aa3295db347da34abf2aa3f9c0a8495b3"></a><!-- doxytag: member="fast_conv_time_space.c::conv_in" ref="aa3295db347da34abf2aa3f9c0a8495b3" args="" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">fftw_complex * <a class="el" href="fast__conv__time__space_8c.html#aa3295db347da34abf2aa3f9c0a8495b3">conv_in</a></td>
        </tr>
      </table>
</div>
<div class="memdoc">

</div>
</div>
<a class="anchor" id="a34a1dd74a6b1cca1cd818e4fe89125fb"></a><!-- doxytag: member="fast_conv_time_space.c::conv_out" ref="a34a1dd74a6b1cca1cd818e4fe89125fb" args="" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">double * <a class="el" href="fast__conv__time__space_8c.html#a34a1dd74a6b1cca1cd818e4fe89125fb">conv_out</a></td>
        </tr>
      </table>
</div>
<div class="memdoc">

</div>
</div>
<a class="anchor" id="a210769c669f4161b1762f71f01b634b7"></a><!-- doxytag: member="fast_conv_time_space.c::conv_plan" ref="a210769c669f4161b1762f71f01b634b7" args="" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">fftw_plan <a class="el" href="fast__conv__time__space_8c.html#a210769c669f4161b1762f71f01b634b7">conv_plan</a></td>
        </tr>
      </table>
</div>
<div class="memdoc">

</div>
</div>
<a class="anchor" id="a750bb45baeee8638cf5e5d206e6c3949"></a><!-- doxytag: member="fast_conv_time_space.c::decay_in" ref="a750bb45baeee8638cf5e5d206e6c3949" args="" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">double* <a class="el" href="fast__conv__time__space_8c.html#a750bb45baeee8638cf5e5d206e6c3949">decay_in</a></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Referenced by <a class="el" href="fast__conv__time__space_8c_source.html#l00163">clear()</a>, <a class="el" href="fast__conv__time__space_8c_source.html#l00109">init()</a>, and <a class="el" href="fast__conv__time__space_8c_source.html#l00205">run()</a>.</p>

</div>
</div>
<a class="anchor" id="a3ebf135f42528ee8a47f822402a90881"></a><!-- doxytag: member="fast_conv_time_space.c::decay_out" ref="a3ebf135f42528ee8a47f822402a90881" args="" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">fftw_complex* <a class="el" href="fast__conv__time__space_8c.html#a3ebf135f42528ee8a47f822402a90881">decay_out</a></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Referenced by <a class="el" href="fast__conv__time__space_8c_source.html#l00163">clear()</a>, <a class="el" href="fast__conv__time__space_8c_source.html#l00109">init()</a>, and <a class="el" href="fast__conv__time__space_8c_source.html#l00205">run()</a>.</p>

</div>
</div>
<a class="anchor" id="aa9d4603278fe2a4bfa666c85e262ccbf"></a><!-- doxytag: member="fast_conv_time_space.c::decay_plan" ref="aa9d4603278fe2a4bfa666c85e262ccbf" args="" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">fftw_plan <a class="el" href="fast__conv__time__space_8c.html#aa9d4603278fe2a4bfa666c85e262ccbf">decay_plan</a></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Referenced by <a class="el" href="fast__conv__time__space_8c_source.html#l00163">clear()</a>, <a class="el" href="fast__conv__time__space_8c_source.html#l00109">init()</a>, and <a class="el" href="fast__conv__time__space_8c_source.html#l00205">run()</a>.</p>

</div>
</div>
<a class="anchor" id="a78e729da50af649061e409638ea413e1"></a><!-- doxytag: member="fast_conv_time_space.c::dimensions" ref="a78e729da50af649061e409638ea413e1" args="" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int <a class="el" href="factor_8c.html#a78e729da50af649061e409638ea413e1">dimensions</a> = 1</td>
        </tr>
      </table>
</div>
<div class="memdoc">

</div>
</div>
<a class="anchor" id="abcd1d810535dcc0097a913eecc39397f"></a><!-- doxytag: member="fast_conv_time_space.c::displacement_dimensions" ref="abcd1d810535dcc0097a913eecc39397f" args="" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int <a class="el" href="fast__conv__time__space_8c.html#abcd1d810535dcc0097a913eecc39397f">displacement_dimensions</a> = 1</td>
        </tr>
      </table>
</div>
<div class="memdoc">

</div>
</div>
<a class="anchor" id="a1e2137d932e474fce316e4ca61db76c9"></a><!-- doxytag: member="fast_conv_time_space.c::fast_spatial_conv" ref="a1e2137d932e474fce316e4ca61db76c9" args=")()" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void(* <a class="el" href="fast__conv__time__space_8c.html#a1e2137d932e474fce316e4ca61db76c9">fast_spatial_conv</a>)() = NULL</td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Referenced by <a class="el" href="fast__conv__time__space_8c_source.html#l00070">request_plugins()</a>, and <a class="el" href="fast__conv__time__space_8c_source.html#l00205">run()</a>.</p>

</div>
</div>
<a class="anchor" id="a254d2de8bdf67e63ad5e840cc445ad2e"></a><!-- doxytag: member="fast_conv_time_space.c::history_in" ref="a254d2de8bdf67e63ad5e840cc445ad2e" args="" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">double * <a class="el" href="fast__conv__time__space_8c.html#a254d2de8bdf67e63ad5e840cc445ad2e">history_in</a></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Referenced by <a class="el" href="fast__conv__time__space_8c_source.html#l00163">clear()</a>, <a class="el" href="fast__conv__time__space_8c_source.html#l00109">init()</a>, and <a class="el" href="fast__conv__time__space_8c_source.html#l00205">run()</a>.</p>

</div>
</div>
<a class="anchor" id="a97c9c64abff99f75e57ed787ed3f43f4"></a><!-- doxytag: member="fast_conv_time_space.c::history_out" ref="a97c9c64abff99f75e57ed787ed3f43f4" args="" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">fftw_complex * <a class="el" href="fast__conv__time__space_8c.html#a97c9c64abff99f75e57ed787ed3f43f4">history_out</a></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Referenced by <a class="el" href="fast__conv__time__space_8c_source.html#l00163">clear()</a>, <a class="el" href="fast__conv__time__space_8c_source.html#l00109">init()</a>, and <a class="el" href="fast__conv__time__space_8c_source.html#l00205">run()</a>.</p>

</div>
</div>
<a class="anchor" id="a753e1caabad13e222ee7553d7b46760c"></a><!-- doxytag: member="fast_conv_time_space.c::history_plan" ref="a753e1caabad13e222ee7553d7b46760c" args="" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">fftw_plan <a class="el" href="fast__conv__time__space_8c.html#a753e1caabad13e222ee7553d7b46760c">history_plan</a></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Referenced by <a class="el" href="fast__conv__time__space_8c_source.html#l00163">clear()</a>, <a class="el" href="fast__conv__time__space_8c_source.html#l00109">init()</a>, and <a class="el" href="fast__conv__time__space_8c_source.html#l00205">run()</a>.</p>

</div>
</div>
<a class="anchor" id="acb559820d9ca11295b4500f179ef6392"></a><!-- doxytag: member="fast_conv_time_space.c::i" ref="acb559820d9ca11295b4500f179ef6392" args="" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int <a class="el" href="fast__conv__time__space_8c.html#acb559820d9ca11295b4500f179ef6392">i</a> = 0</td>
        </tr>
      </table>
</div>
<div class="memdoc">

</div>
</div>
<a class="anchor" id="a600899410b53ff3d9f23d19a43f4d8d8"></a><!-- doxytag: member="fast_conv_time_space.c::is_initialized" ref="a600899410b53ff3d9f23d19a43f4d8d8" args="" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">boolean <a class="el" href="fast__conv__time__space_8c.html#a600899410b53ff3d9f23d19a43f4d8d8">is_initialized</a> = false</td>
        </tr>
      </table>
</div>
<div class="memdoc">

</div>
</div>
<a class="anchor" id="a76f11d9a0a47b94f72c2d0e77fb32240"></a><!-- doxytag: member="fast_conv_time_space.c::n" ref="a76f11d9a0a47b94f72c2d0e77fb32240" args="" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int <a class="el" href="fast__conv__time__space_8c.html#a76f11d9a0a47b94f72c2d0e77fb32240">n</a> = -1</td>
        </tr>
      </table>
</div>
<div class="memdoc">

</div>
</div>
<a class="anchor" id="abe83d1f66400372638644ff6e86f0fb3"></a><!-- doxytag: member="fast_conv_time_space.c::N_T" ref="abe83d1f66400372638644ff6e86f0fb3" args="" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int <a class="el" href="fast__conv__time__space_8c.html#abe83d1f66400372638644ff6e86f0fb3">N_T</a></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Referenced by <a class="el" href="fast__conv__time__space_8c_source.html#l00109">init()</a>, and <a class="el" href="fast__conv__time__space_8c_source.html#l00205">run()</a>.</p>

</div>
</div>
<a class="anchor" id="ac8f4ef93038519a7ba6386b27dd938f1"></a><!-- doxytag: member="fast_conv_time_space.c::result" ref="ac8f4ef93038519a7ba6386b27dd938f1" args="" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">double** <a class="el" href="fast__conv__time__space_8c.html#ac8f4ef93038519a7ba6386b27dd938f1">result</a></td>
        </tr>
      </table>
</div>
<div class="memdoc">

</div>
</div>
<a class="anchor" id="a75532c590dd7f2d95b9756a3edfc69e2"></a><!-- doxytag: member="fast_conv_time_space.c::size_T" ref="a75532c590dd7f2d95b9756a3edfc69e2" args="" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int <a class="el" href="fast__conv__time__space_8c.html#a75532c590dd7f2d95b9756a3edfc69e2">size_T</a> = 0</td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Referenced by <a class="el" href="fast__conv__time__space_8c_source.html#l00109">init()</a>, and <a class="el" href="fast__conv__time__space_8c_source.html#l00205">run()</a>.</p>

</div>
</div>
<a class="anchor" id="a649a9e98ec855fe65a8ab6125d027560"></a><!-- doxytag: member="fast_conv_time_space.c::size_X" ref="a649a9e98ec855fe65a8ab6125d027560" args="" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int <a class="el" href="fast__conv__time__space_8c.html#a649a9e98ec855fe65a8ab6125d027560">size_X</a> = 0</td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Referenced by <a class="el" href="fast__conv__time__space_8c_source.html#l00109">init()</a>, and <a class="el" href="fast__conv__time__space_8c_source.html#l00205">run()</a>.</p>

</div>
</div>
<a class="anchor" id="aaa037180b6867f0f6ea6638aa41328ba"></a><!-- doxytag: member="fast_conv_time_space.c::size_Y" ref="aaa037180b6867f0f6ea6638aa41328ba" args="" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int <a class="el" href="fast__conv__time__space_8c.html#aaa037180b6867f0f6ea6638aa41328ba">size_Y</a> = 0</td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Referenced by <a class="el" href="fast__conv__time__space_8c_source.html#l00109">init()</a>, and <a class="el" href="fast__conv__time__space_8c_source.html#l00205">run()</a>.</p>

</div>
</div>
<a class="anchor" id="aea8a6f9088ed4b42929784a94079a883"></a><!-- doxytag: member="fast_conv_time_space.c::spatial_result" ref="aea8a6f9088ed4b42929784a94079a883" args="" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">double ** <a class="el" href="fast__conv__time__space_8c.html#aea8a6f9088ed4b42929784a94079a883">spatial_result</a></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Referenced by <a class="el" href="fast__conv__time__space_8c_source.html#l00205">run()</a>.</p>

</div>
</div>
<a class="anchor" id="a8668751464d9f21f49861f2c4c8b211e"></a><!-- doxytag: member="fast_conv_time_space.c::t" ref="a8668751464d9f21f49861f2c4c8b211e" args="" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">unsigned long int <a class="el" href="fast__conv__time__space_8c.html#a8668751464d9f21f49861f2c4c8b211e">t</a> = 0</td>
        </tr>
      </table>
</div>
<div class="memdoc">

</div>
</div>
<a class="anchor" id="a6150e0515f7202e2fb518f7206ed97dc"></a><!-- doxytag: member="fast_conv_time_space.c::x" ref="a6150e0515f7202e2fb518f7206ed97dc" args="" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int <a class="el" href="fast__conv__time__space_8c.html#a6150e0515f7202e2fb518f7206ed97dc">x</a> = -1</td>
        </tr>
      </table>
</div>
<div class="memdoc">

</div>
</div>
<a class="anchor" id="a0a2f84ed7838f07779ae24c5a9086d33"></a><!-- doxytag: member="fast_conv_time_space.c::y" ref="a0a2f84ed7838f07779ae24c5a9086d33" args="" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int <a class="el" href="fast__conv__time__space_8c.html#a0a2f84ed7838f07779ae24c5a9086d33">y</a> = -1</td>
        </tr>
      </table>
</div>
<div class="memdoc">

</div>
</div>
</div>
<hr size="1"/><address style="text-align: right;"><small>Generated on Mon Feb 15 18:41:30 2010 for CrusDe by&nbsp;
<a href="http://www.doxygen.org/index.html">
<img class="footer" src="doxygen.png" alt="doxygen"/></a> 1.6.1-20091004 </small></address>
</body>
</html>
